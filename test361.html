<!DOCTYPE html>
<html lang="ko">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5522499110435321" crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>하이틴 사주 오행 정밀 테스트 💖 (Pastel Ver.)</title>
    <meta name="description" content="지장간까지 탈탈 털어 분석했다! 내 사주 진짜 오행 찾기">
    <meta property="og:type" content="website">
    <meta property="og:title" content="하이틴 사주 오행 정밀 테스트 💖">
    <meta property="og:description" content="지장간까지 탈탈 털어 분석했다! 내 사주 진짜 오행 찾기">
    <meta property="og:image" content="img_main_oheang.png">
    <meta property="og:url" content="https://test-it.co.kr/test_oheang">
    
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* [THEME: Soft Pastel High-Teen] */
        :root { 
            --bg-gradient: linear-gradient(180deg, #FFF0F5 0%, #F3E5F5 100%); /* 연한 핑크 -> 연한 보라 */
            --primary: #FFB6C1; /* 파스텔 핑크 */
            --secondary: #CE93D8; /* 파스텔 보라 */
            --accent: #B2EBF2; /* 파스텔 하늘 */
            --text-main: #555; /* 부드러운 진회색 */
            --white: #ffffff;
            /* 테두리와 그림자를 부드럽게 변경 */
            --box-border: 2px solid #FFD1DC; /* 연한 핑크 테두리 */
            --box-shadow: 0px 4px 15px rgba(206, 147, 216, 0.3); /* 은은한 보랏빛 그림자 */
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Pretendard', sans-serif;
            background: var(--bg-gradient); 
            color: var(--text-main); margin: 0; 
            display: flex; flex-direction: column; align-items: center; 
            min-height: 100vh; 
        }

        /* 헤더 스타일 (이전 요청 반영) */
        .page-header {
            width: 100%; max-width: 600px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; 
            background: rgba(255, 255, 255, 0.6); /* 더 투명하게 */
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.8);
            box-shadow: 0 2px 10px rgba(255, 182, 193, 0.1);
            position: sticky; top: 0; z-index: 100;
        }
        .logo { width: 100px; display: block; filter: drop-shadow(1px 1px 2px rgba(255, 182, 193, 0.5)); }
        .main-nav { display: flex; font-size: 0.9rem; list-style: none; margin: 0; padding: 0; align-items: center; }
        .main-nav li { margin-left: 6px; }
        .main-nav a { 
            text-decoration: none; color: #fff; font-weight: 700; 
            background: var(--secondary); padding: 6px 12px; border-radius: 20px;
            border: 2px solid #fff; font-size: 13px;
            box-shadow: 2px 2px 5px rgba(206, 147, 216, 0.3);
            transition: all 0.2s; display: block;
        }
        .main-nav a:hover { background: var(--primary); transform: translateY(-2px); box-shadow: 3px 3px 8px rgba(255, 182, 193, 0.4); }

        .container { 
            width: 100%; max-width: 600px; 
            background: #fff;
            /* 배경 패턴도 더 은은하게 */
            background-image: linear-gradient(#F8F8F8 1px, transparent 1px), linear-gradient(90deg, #F8F8F8 1px, transparent 1px);
            background-size: 20px 20px;
            border: var(--box-border);
            border-radius: 25px; /* 더 둥글게 */
            box-shadow: var(--box-shadow);
            margin: 20px 0 50px 0; 
            padding-bottom: 30px;
            overflow: hidden;
            position: relative;
        }
        
        .page { display: none; flex-direction: column; padding: 40px 25px; animation: fadeIn 0.6s ease-out; }
        .page.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* 메인 페이지 */
        .main-title {
            font-size: 28px; font-weight: 800; text-align: center; color: var(--secondary);
            text-shadow: 2px 2px 0px #fff, 3px 3px 0px #FFE4E1; /* 그림자 부드럽게 */
            margin-bottom: 10px; line-height: 1.3;
        }

        .form-group { margin-bottom: 25px; }
        .label { 
            font-size: 15px; font-weight: 700; color: #fff; 
            margin-bottom: 8px; display: block; 
            background: var(--secondary); display: inline-block; padding: 5px 12px; border-radius: 15px; 
            box-shadow: 2px 2px 5px rgba(206, 147, 216, 0.3);
            border: none; /* 검정 테두리 제거 */
        }
        .toggle-box { display: flex; gap:10px; background: #F8F8F8; padding: 5px; border-radius: 15px; }
        .toggle-btn { 
            flex: 1; padding: 10px; border: none;
            background: transparent; font-weight: 700; color: #aaa; 
            cursor: pointer; border-radius: 12px; transition: 0.3s; 
        }
        .toggle-btn.active { 
            background: #fff; color: var(--secondary); 
            box-shadow: 2px 2px 8px rgba(0,0,0,0.05); 
            color: var(--primary);
        }
        
        select { 
            width: 100%; padding: 14px; border: 2px solid #F0F0F0; border-radius: 15px; 
            font-size: 16px; background: #fff; font-family: inherit; font-weight:600; color: var(--text-main);
            box-shadow: 2px 2px 8px rgba(0,0,0,0.03); transition: 0.3s;
            -webkit-appearance: none; /* 모바일 사파리 기본 스타일 제거 */
            background: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23CE93D8' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right 12px center / 8px 10px, #fff; /* 화살표 커스텀 */
        }
        select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(255, 182, 193, 0.3); }
        .date-grid { display: grid; grid-template-columns: 1.3fr 1fr 1fr; gap: 8px; }

        .btn-main { 
            width: 100%; padding: 16px; 
            background: var(--primary); 
            color: #fff; border: none; border-radius: 50px; 
            font-size: 18px; font-weight: 800; cursor: pointer; margin-top: 20px; 
            box-shadow: 0 4px 10px rgba(255, 182, 193, 0.5);
            transition: all 0.3s; 
            letter-spacing: 1px;
        }
        .btn-main:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(255, 182, 193, 0.7); background: #FFC0CB; }
        .btn-main.btn-save { background: var(--secondary); box-shadow: 0 4px 10px rgba(206, 147, 216, 0.5); }
        .btn-main.btn-save:hover { background: #E1BEE7; box-shadow: 0 6px 15px rgba(206, 147, 216, 0.7); }

        .result-header { 
            text-align: center; margin-bottom: 30px; 
            background: #fff; padding: 40px 20px 30px; 
            border-bottom: 2px dashed #F0F0F0;
            border-radius: 0 0 30px 30px;
        }
        
        .ilju-badge { 
            background: var(--secondary); color: #fff; 
            padding: 8px 20px; border-radius: 30px; 
            font-size: 15px; font-weight: 800; display: inline-block; 
            transform: rotate(-2deg); margin-bottom: 15px;
            box-shadow: 3px 3px 10px rgba(206, 147, 216, 0.4);
        }

        .element-circle {
            width: 140px; height: 140px; border-radius: 50%;
            background: #fff;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            margin: 0 auto 20px;
            border: 5px solid var(--primary); /* 기본 파스텔 테두리 */
            box-shadow: 0 5px 20px rgba(255, 182, 193, 0.3); /* 부드러운 그림자 */
            transition: 0.3s;
        }
        .element-char { 
            font-size: 50px; margin-bottom: 5px; 
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.1)); 
            display:flex; justify-content:center; gap:5px;
        }
        .element-name { 
            font-size: 16px; font-weight: 800; color: #fff; margin-top:5px; 
            background: var(--secondary); padding: 4px 15px; border-radius: 15px; border: none;
            box-shadow: 2px 2px 5px rgba(206, 147, 216, 0.3);
        }
        
        .card { 
            background: #fff; border-radius: 25px; padding: 30px 25px; margin-bottom: 25px; 
            border: none; /* 검정 테두리 제거 */
            box-shadow: 0 5px 20px rgba(0,0,0,0.05); /* 아주 부드러운 그림자 */
            position: relative; overflow: hidden;
        }
        .card-head { 
            font-size: 20px; font-weight: 800; color: var(--secondary); 
            margin-bottom: 20px; display: inline-block;
            background: linear-gradient(to top, #FFE4E1 40%, transparent 40%); /* 형광펜 효과 파스텔로 */
            padding: 0 5px;
        }
        
        .long-text { 
            font-size: 15px; line-height: 1.8; color: var(--text-main); 
            text-align: left; word-break: keep-all; font-weight: 500;
        }
        .keyword-tag {
            display: inline-block; background: var(--primary); color: #fff; 
            padding: 5px 12px; border-radius: 15px; font-size: 13px; font-weight: bold;
            margin-right: 6px; margin-bottom: 8px;
            box-shadow: 2px 2px 5px rgba(255, 182, 193, 0.3);
        }

        .chart-container { 
            position: relative; height: 240px; width: 100%; margin-top: 15px; padding: 15px; 
            background: #FAFAFA; border-radius: 20px; border: 2px dashed #F0F0F0; 
        }

        .lucky-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .lucky-box { 
            background: #FFF0F5; border-radius: 20px; padding: 20px 15px; text-align: center; 
            border: 2px solid var(--primary); /* 파스텔 핑크 테두리 */
            box-shadow: 3px 3px 10px rgba(255, 182, 193, 0.2);
            transition: 0.3s;
        }
        .lucky-box:hover { transform: translateY(-3px); box-shadow: 5px 5px 15px rgba(255, 182, 193, 0.3); }
        .lucky-icon { font-size: 32px; margin-bottom: 8px; display: block; }
        .lucky-label { font-size: 13px; color: var(--primary); font-weight: 800; display: block; margin-bottom: 5px; }
        .lucky-val { font-size: 15px; font-weight: 800; color: var(--text-main); word-break: keep-all;}

    /* [NEW] 하이틴 감성 로딩 화면 스타일 */
        #p-loading { 
            background: var(--bg-gradient); 
            align-items: center; justify-content: center; height: 100vh;
            position: relative; overflow: hidden;
            z-index: 999;
        }

        /* 반짝이는 배경 효과 */
        .sparkle-bg {
            position: absolute; width: 100%; height: 100%; pointer-events: none;
            background-image: 
                radial-gradient(#fff 20%, transparent 20%),
                radial-gradient(#fff 20%, transparent 20%);
            background-position: 0 0, 50px 50px;
            background-size: 100px 100px;
            opacity: 0.3;
            animation: twinkle 4s linear infinite;
        }
        @keyframes twinkle { 0% {opacity:0.3; transform:scale(1);} 50% {opacity:0.6; transform:scale(1.1);} 100% {opacity:0.3; transform:scale(1);} }

        /* 로딩 컨텐츠 박스 */
        .loading-box {
            text-align: center; position: relative; z-index: 10;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(5px);
            padding: 40px; border-radius: 30px;
            border: 3px solid #fff;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.3);
        }

        /* 중앙 마법 아이콘 애니메이션 */
        .magic-loader { position: relative; width: 100px; height: 100px; margin: 0 auto 30px; }
        .crystal-ball { font-size: 60px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2; }
        
        .orbit {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            animation: rotate 3s linear infinite;
        }
        .orbit span {
            position: absolute; font-size: 24px;
        }
        /* 5행 아이콘 배치 */
        .orbit span:nth-child(1) { top: 0; left: 50%; transform: translate(-50%, -50%); }
        .orbit span:nth-child(2) { top: 30%; right: 0; transform: translate(50%, -50%); }
        .orbit span:nth-child(3) { bottom: 0; right: 20%; transform: translate(50%, 50%); }
        .orbit span:nth-child(4) { bottom: 0; left: 20%; transform: translate(-50%, 50%); }
        .orbit span:nth-child(5) { top: 30%; left: 0; transform: translate(-50%, -50%); }

        @keyframes rotate { 100% { transform: rotate(360deg); } }

        /* 텍스트 스타일 */
        .loading-title { color: var(--secondary); font-size: 22px; font-weight: 900; margin-bottom: 10px; letter-spacing: 1px; }
        .loading-desc { color: var(--text-main); font-size: 15px; font-weight: 600; line-height: 1.6; margin-bottom: 25px; }

        /* [NEW] 스트라이프 로딩바 (어닝 느낌) */
        .progress-container {
            width: 200px; height: 16px; background: #fff;
            border-radius: 20px; margin: 0 auto;
            border: 2px solid var(--primary);
            overflow: hidden; padding: 2px;
        }
   /* [수정됨] 로딩바가 3초 동안 차오르도록 애니메이션 추가 */
        .progress-bar {
            height: 100%; 
            width: 0%; /* 0에서 시작 */
            border-radius: 10px;
            background: repeating-linear-gradient(
                45deg,
                var(--primary),
                var(--primary) 10px,
                #FFC3D0 10px,
                #FFC3D0 20px
            );
            background-size: 200% 100%;
            /* 줄무늬 이동(20s) + 게이지 차오르기(3s) 동시 적용 */
            animation: 
                stripe-move 20s linear infinite, 
                fill-bar 3s ease-in-out forwards; 
        }

        /* 게이지 차오르는 키프레임 */
        @keyframes fill-bar {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        @keyframes stripe-move { 0% { background-position: 100% 0; } 100% { background-position: 0 0; } }

        .snapshot-mode .chart-container { transform: none !important; }
        .coupang_ad { width: 100%; margin: 0 auto; text-align: center; overflow:hidden; border-radius:20px; border: 2px solid #F0F0F0; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }

    </style>
</head>

<body> 

    <header class="page-header">
        <h1>
            <a href="index.html">
                <img class="logo" src="img_logo.png" alt="TEST IT">
            </a>
        </h1>
        <nav>
            <ul class="main-nav">
                <li><a href="https://test-it.co.kr/test.html">성격</a></li>
                <li><a href="https://test-it.co.kr/face.html">얼굴</a></li>
                <li><a href="https://test-it.co.kr/etc.html">그외</a></li>
                <li><a href="https://test-it.co.kr/saju.html">사주</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        
        <div id="p-main" class="page active" style="justify-content: center; padding: 40px 30px;">
            <div class="logo-area" style="margin: 0 0 35px 0; text-align:center;">
                <img src="img_main_oheang.png" alt="오행테스트" style="width: 100%; border-radius:20px; border:3px solid var(--primary); box-shadow: 0 8px 20px rgba(255, 182, 193, 0.4);">
            </div>
           
            <button class="btn-main" onclick="nav('p-input')">테스트 START ✨</button>
        </div>

        <div id="p-input" class="page">
            <h2 style="text-align:center; margin-bottom:30px; font-size:22px; font-weight:800; color:var(--secondary);">내 정보📝</h2>
            
            <div class="form-group">
                <span class="label">📅 달력 기준</span>
                <div class="toggle-box">
                    <button class="toggle-btn active" id="btn-solar" onclick="setCal('solar')">양력</button>
                    <button class="toggle-btn" id="btn-lunar" onclick="setCal('lunar')">음력</button>
                </div>
                <input type="hidden" id="cal-type" value="solar">
            </div>

            <div class="form-group">
                <span class="label">🎂 생년월일</span>
                <div class="date-grid">
                    <select id="sel-year"></select>
                    <select id="sel-month"></select>
                    <select id="sel-day"></select>
                </div>
            </div>

            <div class="form-group">
                <span class="label">⏰ 태어난 시간</span>
                <select id="sel-time">
                    <option value="99">모름</option>
                    <option value="0">자시 (23:30 ~ 01:29)</option>
                    <option value="2">축시 (01:30 ~ 03:29)</option>
                    <option value="4">인시 (03:30 ~ 05:29)</option>
                    <option value="6">묘시 (05:30 ~ 07:29)</option>
                    <option value="8">진시 (07:30 ~ 09:29)</option>
                    <option value="10">사시 (09:30 ~ 11:29)</option>
                    <option value="12">오시 (11:30 ~ 13:29)</option>
                    <option value="14">미시 (13:30 ~ 15:29)</option>
                    <option value="16">신시 (15:30 ~ 17:29)</option>
                    <option value="18">유시 (17:30 ~ 19:29)</option>
                    <option value="20">술시 (19:30 ~ 21:29)</option>
                    <option value="22">해시 (21:30 ~ 23:29)</option>
                </select>
            </div>

            <button class="btn-main" onclick="processResult()">결과 분석하기</button>
        </div>

<div id="p-loading" class="page">
            <div class="sparkle-bg"></div>
            
            <div class="loading-box">
                <div class="magic-loader">
                    <div class="crystal-ball">🔮</div>
                    <div class="orbit">
                        <span>🌲</span> <span>🔥</span> <span>⛰️</span> <span>💎</span> <span>🌊</span> </div>
                </div>

                <h3 class="loading-title">사주 오행 분석 중...</h3>
                <p class="loading-desc">숨겨진 당신의 진짜 모습을<br>꼼꼼하게 찾고 있어요! 🔍</p>
                
                <div class="progress-container">
                    <div class="progress-bar"></div>
                </div>
            </div>
        </div>

        <div id="p-result" class="page" style="padding:0;">
            <div id="capture-area" style="padding: 0 20px 40px 20px;">
                
                <div class="result-header">
                    <div class="ilju-badge" id="my-ilju">--일주</div>
                    <h2 style="margin:0 0 25px 0; color:var(--text-main); font-size:22px; font-weight:800;">나의 오행 리포트</h2>
                    
                    <div class="element-circle" id="main-el-circle">
                        <span class="element-char" id="main-char">🔥</span>
                        <span class="element-name" id="main-name">화(火)형</span>
                    </div>
                    <div style="font-size:15px; color:var(--text-main); font-weight:700; background:#F8F8F8; padding:12px 20px; border-radius:20px; display:inline-block; box-shadow: inset 2px 2px 5px rgba(0,0,0,0.05);">
                        Main Energy : <span id="main-desc-short" style="color:var(--primary); font-weight:900;">--</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-head">📊 에너지 분포도</div>
                    <div class="chart-container">
                        <canvas id="elementChart"></canvas>
                    </div>
                    <p style="text-align:center; font-size:13px; color:#999; margin-top:12px; font-weight:500;">* 숨겨진 기운(지장간)까지 포함된 수치야!</p>
                </div>

                <div class="card" style="background:#FFF0F5;"> 
                    <div class="card-head">👑 나의 최강 에너지 (과다)</div>
                    <div id="res-max-title" style="font-size:18px; font-weight:800; margin-bottom:12px; color:var(--text-main);">--</div>
                    <div class="long-text" id="res-max-desc">--</div>
                </div>

                <div class="card" style="background:#E0F7FA;">
                    <div class="card-head" id="min-card-head">💧 나의 부족 에너지 (결핍)</div>
                    <div id="res-min-title" style="font-size:18px; font-weight:800; margin-bottom:12px; color:var(--text-main);">--</div>
                    <div class="long-text" id="res-min-desc">--</div>
                </div>

                <div class="card">
                    <div class="card-head" style="color:var(--secondary);">🍀 Lucky Item & Color</div>
                    <div class="lucky-grid">
                        <div class="lucky-box">
                            <span class="lucky-icon" id="lucky-color-icon">🎨</span>
                            <span class="lucky-label">LUCKY COLOR</span>
                            <div class="lucky-val" id="lucky-color">--</div>
                        </div>
                        <div class="lucky-box">
                            <span class="lucky-icon" id="lucky-item-icon">🧸</span>
                            <span class="lucky-label">LUCKY ITEM</span>
                            <div class="lucky-val" id="lucky-item">--</div>
                        </div>
                    </div>
                </div>

                <div style="text-align:center; color:#aaa; font-size:12px; margin-top:25px; font-weight:500;">@테스트잇 사주 오행 성격 테스트</div>
            </div>

       <div style="padding: 0 25px 50px 25px; display: flex; flex-direction: column; gap: 15px;">
                
                <button class="btn-main btn-save" onclick="saveImage()">결과 이미지 저장하기 📸</button>
                
                <button class="btn-main" style="background: #ffa2b9; color:#fff; font-size:16px; margin-top:0; box-shadow: 0 4px 10px rgba(197, 176, 181, 0.5);" onclick="location.reload()">다시 하기 🔄</button>
                
                <button class="btn-main" style="background: #ffbb00; color:#fff; font-size:16px; margin-top:0; box-shadow: 0 4px 10px rgba(255, 204, 128, 0.5);" onclick="location.href='https://test-it.co.kr'">다른 테스트 해보기 🚀</button>
                
                <button class="btn-main" id="share-btn" style="background: #fff; color:var(--secondary); border: 2px solid var(--secondary); font-size:16px; margin-top:0; box-shadow: 0 4px 10px rgba(206, 147, 216, 0.3);">테스트 공유 하기 🔗</button>
            
            </div>
            
            <article class="coupang_ad mt-3" style="margin: 0 20px 20px 20px;">
                <script src="https://ads-partners.coupang.com/g.js"></script>
                <script>
                    new PartnersCoupang.G({"id":798186,"template":"carousel","trackingCode":"AF4391881","width":"320","height":"100","tsource":""});
                </script>
            </article>
        </div>
        
    </div> 
    
<script>
    /* [데이터베이스: 하이틴 사주 정밀 분석 Ver.Max] 
       모든 설명은 단순 나열이 아닌 '융합 화학 작용'을 기반으로 작성됨.
    */

    /* 1. 단일 과다 (5개) - 한 기운이 압도적일 때 */
    const SINGLE_GUIDE = {
        'wood': {
            name: "목(Wood)", char: "🌲", color: "#4CAF50",
            title: "하늘을 찌르는 거대한 숲",
            desc: `
                <div class='keyword-tag'>#불도저</div><div class='keyword-tag'>#자수성가</div><div class='keyword-tag'>#명예욕</div><br><br>
                <b>[성격 심층 분석]</b><br>
                당신은 태생적으로 '성장'에 대한 갈망이 엄청난 사람이야. 남들은 적당히 현실에 안주할 때, 너는 끊임없이 "다음은 뭐지?"를 고민하며 위로 올라가려고 해. 한 번 목표를 정하면 앞뒤 안 재고 뚫고 나가는 추진력 하나는 우주 최강이지. 🚀 <br>
                남한테 굽히는 걸 죽기보다 싫어하고, 내가 대장이 되어야 직성이 풀리는 '대장부' 기질이 있어. 겉으로는 부드러워 보여도 속에는 엄청난 자존심과 경쟁심이 용암처럼 끓고 있지.<br><br>
                <b>[장점 & 매력 포인트]</b><br>
                실패해도 오뚝이처럼 다시 일어나는 회복탄력성이 미쳤어! 🌱 남들이 포기할 때 너는 기어코 해내고야 마는 뚝심이 있지. 순수하고 어린아이 같은 호기심이 있어서 새로운 분야에 도전하는 걸 두려워하지 않아. 네가 리더를 맡으면 팀원들은 든든함을 느껴.<br><br>
                <b>[주의할 점 (팩폭)]</b><br>
                시작은 창대한데 끝이 미약할 수 있어. 😅 기분파 기질이 있어서 욱하고 저질렀다가 나중에 수습하느라 고생하기도 해. 그리고 남의 말을 좀 더 귀담아듣고, 융통성을 기르면 진짜 천하무적이 될 거야.
            `,
            lowTitle: "뿌리 없는 묘목",
            lowDesc: "<b>[결핍 분석]</b> 시작하는 힘이 너무 약해. '해야지...' 하고 생각만 하다가 1년이 지나가. 😅 귀가 얇아서 남의 말에 잘 휘둘리고, 뚝심이 부족해서 마무리가 흐지부지될 때가 많아.",
            lucky: { color: "그린, 카키, 블루", item: "나무 재질의 소품, 식물, 다이어리" }
        },
        'fire': {
            name: "화(Fire)", char: "🔥", color: "#FF5252",
            title: "세상을 비추는 강렬한 태양",
            desc: `
                <div class='keyword-tag'>#핵인싸</div><div class='keyword-tag'>#솔직당당</div><div class='keyword-tag'>#예술가</div><br><br>
                <b>[성격 심층 분석]</b><br>
                숨만 쉬어도 존재감이 뿜뿜! ✨ 어딜 가나 스포트라이트를 받아야 하는 '주인공' 재질이야. 너는 감정을 숨기지 못해서 좋고 싫음이 얼굴에 다 드러나는 투명한 영혼을 가졌어. <br>
                화려하고 아름다운 것을 사랑하는 미적 감각이 뛰어나고, 예의범절을 중요하게 생각해서 깍듯하다는 소리를 들어. 하지만 네 기준에서 벗어나면 불같이 화를 내기도 해.<br><br>
                <b>[장점 & 매력 포인트]</b><br>
                뒤끝이라곤 1도 없는 쿨한 성격! 화끈하게 화내고 화끈하게 잊어버려서 주변 사람들을 편안하게 해줘. 사람을 끌어당기는 매력이 있어서 영업이나 방송, 예술 쪽으로 가면 대박 날 사주야. 너의 열정은 전염성이 있어서 주변까지 밝게 만들어.<br><br>
                <b>[주의할 점 (팩폭)]</b><br>
                냄비처럼 확 끓었다가 확 식어버리는 게 문제야. 🌡️ 끈기가 부족하다는 소리를 들을 수 있어. 그리고 욱하는 성질 때문에 말실수로 소중한 사람에게 상처를 줄 수 있으니 '3초만 참기' 운동을 해봐!
            `,
            lowTitle: "꺼져가는 촛불",
            lowDesc: "<b>[결핍 분석]</b> 매사에 의욕이 없고 세상이 흑백으로 보여. 🌑 표현을 잘 안 해서 속을 알 수 없다는 소리를 듣고, 소심하고 비관적인 생각에 빠지기 쉬워. 자신감이 시급해!",
            lucky: { color: "레드, 핑크, 퍼플", item: "화려한 조명, 캔들, 붉은색 액세서리" }
        },
        'earth': {
            name: "토(Earth)", char: "⛰️", color: "#FFCA28",
            title: "모든 것을 품는 거대한 대지",
            desc: `
                <div class='keyword-tag'>#신뢰의아이콘</div><div class='keyword-tag'>#중재자</div><div class='keyword-tag'>#뚝심</div><br><br>
                <b>[성격 심층 분석]</b><br>
                친구들이 비밀 이야기를 털어놓고 싶은 1순위! 👂 너는 묵묵하게 들어주고 비밀을 무덤까지 가져가는 의리파야. 변화를 싫어하고 안정을 추구해서, 한 자리에서 뚝심 있게 버티는 능력이 탁월해. <br>
                남들이 싸울 때 가운데서 중재하는 평화주의자 역할을 자주 맡지. 하지만 한 번 화나면 지진이 난 것처럼 무섭게 변하기도 해.<br><br>
                <b>[장점 & 매력 포인트]</b><br>
                사람을 가리지 않고 포용하는 넓은 마음씨를 가졌어. 어떤 시련이 와도 쉽게 흔들리지 않는 멘탈 갑! 🧱 부동산이나 저축처럼 차곡차곡 쌓아서 부자가 되는 능력이 있어. 네가 있으면 왠지 모르게 마음이 편안해져.<br><br>
                <b>[주의할 점 (팩폭)]</b><br>
                속을 알 수 없다는 소리를 자주 들어. 😶 표현을 너무 안 해서 연인이나 가족이 답답해할 수 있어(고구마 100개). 그리고 한 번 고집부리면 아무도 못 꺾는데, 가끔은 유연하게 대처하는 센스가 필요해!
            `,
            lowTitle: "기반이 약한 모래사장",
            lowDesc: "<b>[결핍 분석]</b> 마음이 불안정해서 한곳에 정착을 못 해. 🌪️ 싫증을 잘 느끼고 이직이나 이사를 너무 자주 다닐 수 있어. 사람을 잘 못 믿거나, 반대로 너무 쉽게 믿어서 사기당할 수 있으니 조심!",
            lucky: { color: "옐로우, 베이지, 브라운", item: "도자기, 스카프, 흙이나 돌 소재의 장식" }
        },
        'metal': {
            name: "금(Metal)", char: "💎", color: "#90A4AE",
            title: "냉철하고 예리한 명검",
            desc: `
                <div class='keyword-tag'>#완벽주의</div><div class='keyword-tag'>#원칙맨</div><div class='keyword-tag'>#카리스마</div><br><br>
                <b>[성격 심층 분석]</b><br>
                호불호가 확실하고 맺고 끊음이 칼 같은 '차도녀/차도남' 스타일! 🔪 흐지부지한 걸 질색하고, 한 번 시작하면 완벽하게 끝내야 직성이 풀리는 결벽증적인 면모가 있어. <br>
                의리를 목숨보다 중요하게 생각해서 내 사람이다 싶으면 확실하게 챙기는 리더십도 있지. 너는 감정보다는 이성을, 과정보다는 결과를 중요하게 생각해.<br><br>
                <b>[장점 & 매력 포인트]</b><br>
                일 처리 하나는 기가 막히게 깔끔해. 분석력과 결단력이 좋아서 위기 상황에서도 당황하지 않고 해결책을 찾아내지. 군더더기 없는 깔끔한 매력 때문에 따르는 사람이 많아. 너에게 일을 맡기면 안심이 돼.<br><br>
                <b>[주의할 점 (팩폭)]</b><br>
                말이 너무 직설적이라 본의 아니게 팩트폭력으로 뼈를 때려. 🦴 너는 맞는 말만 했지만 상대방은 상처받을 수 있다는 걸 기억해. 조금만 더 부드럽게 말하는 '쿠션 화법'을 장착하면 완벽해질 거야.
            `,
            lowTitle: "다듬어지지 않은 원석",
            lowDesc: "<b>[결핍 분석]</b> 우유부단함의 끝판왕. 🤯 메뉴 고르는 데 하루 종일 걸려. 거절을 못 해서 실속 없이 남 좋은 일만 시킬 수 있어. 'NO'라고 말하는 연습이 필요해.",
            lucky: { color: "화이트, 실버, 골드", item: "메탈 시계, 반지, 금속 액세서리" }
        },
        'water': {
            name: "수(Water)", char: "🌊", color: "#29B6F6",
            title: "깊고 넓은 지혜의 바다",
            desc: `
                <div class='keyword-tag'>#천재</div><div class='keyword-tag'>#처세술</div><div class='keyword-tag'>#유연함</div><br><br>
                <b>[성격 심층 분석]</b><br>
                머리 회전이 빠르고 눈치가 100단인 지략가 타입이야! 🧠 어떤 그릇에 담느냐에 따라 모양이 변하는 물처럼, 어떤 상황에서도 유연하게 대처하는 임기응변 능력이 타의 추종을 불허해. <br>
                겉으로는 웃고 있지만 속으로는 이미 모든 계산을 끝낸 반전 매력의 소유자지. 남들이 못 보는 이면을 꿰뚫어 보는 통찰력이 있어.<br><br>
                <b>[장점 & 매력 포인트]</b><br>
                창의력과 기획력이 뛰어나서 남들이 생각지 못한 아이디어를 잘 내. 사람의 심리를 꿰뚫어 보는 통찰력이 있어서 상담가나 기획자로 대성할 수 있어. 조용하지만 강한 실속파! 물이 바위를 뚫듯 꾸준함도 가지고 있어.<br><br>
                <b>[주의할 점 (팩폭)]</b><br>
                생각이 꼬리에 꼬리를 물어서 혼자 동굴로 들어갈 때가 있어. 🕳️ 너무 속내를 드러내지 않으면 음흉하다는 오해를 살 수 있으니, 가끔은 솔직하게 "나 지금 힘들어!"라고 말하는 용기가 필요해.
            `,
            lowTitle: "물기 없는 사막",
            lowDesc: "<b>[결핍 분석]</b> 융통성이 제로야. 🌵 상황 대처 능력이 떨어져서 예상치 못한 일이 터지면 그대로 고장 나버려. 남의 눈치를 너무 안 보거나, 반대로 분위기 파악을 못 할 때가 있어.",
            lucky: { color: "블랙, 네이비, 차콜", item: "향수, 어항, 검은색 지갑" }
        }
    };

    /* 2. 2개 과다 융합 (10개) - 케미스트리 심층 분석 */
    const PAIR_GUIDE = {
        'fire-wood': { // 목화통명
            title: "🔥 활활 타오르는 불꽃나무 (목+화)",
            desc: `
                <b>[융합 성격: 천재적인 아이디어 뱅크]</b><br>
                나무(목)가 불(화)을 만나 땔감이 되어주니, 에너지가 폭발하는 형국이야! 🌲🔥 <br>
                너는 '목'의 끊임없는 호기심과 '화'의 화려한 표현력이 합쳐져서 엄청난 시너지를 내고 있어. 머리가 비상하고, 하나를 배우면 열을 아는 총명함을 가졌지. 아이디어가 샘솟고 그것을 현실화시키는 능력까지 겸비한 <b>'슈퍼 크리에이터'</b>야. 겉으로는 밝아 보이지만 내면에는 세상을 바꾸고 싶은 거대한 야망이 숨어 있어.<br><br>
                <b>[행동 패턴]</b><br>
                생각나면 바로 실행해야 해. 밤새서라도 결과를 만들어내고야 마는 열정파! 남들 앞에 서는 걸 즐기고, 칭찬받으면 춤추는 고래처럼 더 잘해.<br><br>
                <b>[주의할 점]</b><br>
                기분이 너무 업다운이 심할 수 있어. 🔥 감정이 격해지면 앞뒤 안 가리고 폭주할 수 있으니 <b>'감정 브레이크'</b>가 필수야. 너무 잘나서 남들의 질투를 살 수 있으니 겸손함만 갖추면 성공 확정!
            `,
            color: "#FF7043", char: "🚀"
        },
        'earth-wood': { // 목극토
            title: "🌳 숲을 개척하는 빌더 (목+토)",
            desc: `
                <b>[융합 성격: 현실적인 야망가]</b><br>
                단단한 땅(토)에 뿌리를 깊게 내리려는 나무(목)의 모습이야. 🌲⛰️ <br>
                이상을 추구하는 '목'의 성향과, 현실 안정을 추구하는 '토'의 성향이 부딪히면서 강력한 <b>'개척 정신'</b>을 만들어냈어. 맨땅에 헤딩해서라도 기어코 성과를 만들어내는 자수성가형 부자들이 많아. 겉으론 유해 보여도 속은 엄청 단단한 외유내강형이지. 남들이 "그게 되겠어?"라고 할 때 묵묵히 증명해내는 사람이야.<br><br>
                <b>[행동 패턴]</b><br>
                겉으로는 느긋해 보이는데 머릿속은 계산하느라 바빠. 목표를 세우면 치밀하게 계획하고, 한 번 물면 절대 놓지 않아. 재물에 대한 감각이 남달라.<br><br>
                <b>[주의할 점]</b><br>
                내면의 갈등이 많아 스트레스를 잘 받아. 현실과 이상 사이에서 끊임없이 고민하다가 위장병이 생길 수 있어. 💊 가끔은 머리를 비우고 단순하게 생각하는 휴식이 필요해.
            `,
            color: "#8D6E63", char: "🏗️"
        },
        'metal-wood': { // 금극목
            title: "🪓 다듬어진 조각상 (목+금)",
            desc: `
                <b>[융합 성격: 개혁하는 완벽주의자]</b><br>
                거친 나무(목)를 예리한 도끼(금)로 다듬어 멋진 작품을 만드는 형국이야! 🌲💎 <br>
                뻗어나가려는 '목'의 욕망을 '금'의 이성이 통제해주기 때문에 절제미와 카리스마가 넘쳐. 리더십이 강하고 결단력이 있어서 조직을 이끄는 리더나 CEO에 딱 맞는 성격이야. 너는 "대충"이라는 단어를 제일 싫어해. 확실한 성과와 보상을 원하고, 공과 사의 구분이 칼같이 정확하지.<br><br>
                <b>[행동 패턴]</b><br>
                목표가 생기면 불도저처럼 밀고 나가는데, 디테일도 놓치지 않아. 어려운 난관이 와도 돌파해버리는 힘이 있어. 남들이 쩔쩔매는 문제도 너는 단번에 해결책을 찾아내.<br><br>
                <b>[주의할 점]</b><br>
                자신에게도 엄격하고 남에게도 엄격해서 주변 사람들이 피곤해할 수 있어. "나를 따르라!"고 강요하기보다는 부드럽게 설득하는 법을 배워야 해. 융통성 한 스푼만 넣으면 완벽해! 🥄
            `,
            color: "#78909C", char: "🗽"
        },
        'water-wood': { // 수생목
            title: "🌿 물을 머금은 버드나무 (목+수)",
            desc: `
                <b>[융합 성격: 지혜로운 멘토]</b><br>
                물(수)을 머금고 쑥쑥 자라는 나무(목)처럼, 배움에 대한 열정이 가득해! 🌊🌲 <br>
                '수'의 깊은 지혜와 '목'의 어진 마음씨가 합쳐져서 사람들을 잘 챙기고 교육하는 능력이 탁월해. 감수성이 풍부하고 창의적인 아이디어가 넘쳐나는 <b>'감성 지능'</b>이 높은 타입이야. 경쟁보다는 상생을 추구하고, 평화로운 방식으로 세상을 바꾸고 싶어 해.<br><br>
                <b>[행동 패턴]</b><br>
                하나를 파고들면 끝장을 보는 학구파야. 기획, 연구, 교육, 예술 분야에서 두각을 나타내. 사람의 마음을 움직이는 따뜻한 화법을 구사해.<br><br>
                <b>[주의할 점]</b><br>
                생각이 너무 많아서 결정장애가 올 수 있어. 🤔 완벽하게 준비될 때까지 기다리다가 기회를 놓치기도 해. 생각할 시간에 일단 저지르는 '목'의 기운을 좀 더 써먹어봐!
            `,
            color: "#009688", char: "🎓"
        },
        'earth-fire': { // 화생토
            title: "🌋 뜨거운 용암과 대지 (화+토)",
            desc: `
                <b>[융합 성격: 포용력 있는 보스]</b><br>
                불(화)이 흙(토)을 단단하게 구워주는 도자기 같은 사람이야. 🔥⛰️ <br>
                '화'의 뜨거운 열정을 '토'가 차분하게 갈무리해주니, 겉으로는 점잖아 보이지만 속에는 엄청난 에너지를 품고 있어. 사람들을 아우르는 리더십이 있고, 한 번 맺은 인연은 끝까지 챙기는 의리파야. 너는 사람을 모으고 조직을 키우는 데 천부적인 재능이 있어.<br><br>
                <b>[행동 패턴]</b><br>
                남을 위해 봉사하고 희생할 줄 알아. 신뢰감이 높아서 사람들이 자연스럽게 너를 따르게 돼. 하지만 한 번 화나면 화산 폭발처럼 무서워.<br><br>
                <b>[주의할 점]</b><br>
                고집이 세도 너무 세(황소고집 🐂). 내가 맞다고 생각하면 절대 안 굽혀. 그리고 게으름이 발동하면 끝도 없이 늘어질 수 있으니, 스스로를 채찍질하는 습관이 필요해.
            `,
            color: "#FBC02D", char: "🏺"
        },
        'fire-metal': { // 화극금
            title: "💍 제련된 화려한 보석 (화+금)",
            desc: `
                <b>[융합 성격: 화려한 스타 플레이어]</b><br>
                뜨거운 불(화)로 쇠(금)를 녹여 명품을 만들어내는 모습이야. 🔥💎 <br>
                눈부시게 화려하고 예리한 감각을 가졌어. '화'의 화려한 쇼맨십과 '금'의 확실한 결단력이 합쳐져서 어딜 가나 시선 집중! 성격이 급하고 불같지만, 능력 하나는 확실해서 미워할 수 없는 <b>'능력캐'</b>야. 트렌드를 읽는 눈이 빠르고, 남들보다 앞서나가는 감각이 있어.<br><br>
                <b>[행동 패턴]</b><br>
                목표를 달성하기 위해 물불 가리지 않는 승부사야. 패션, 디자인, 마케팅 등 트렌드에 민감한 분야에서 최고가 될 수 있어. 지루한 건 딱 질색!<br><br>
                <b>[주의할 점]</b><br>
                독설 조심! 💣 욱하는 마음에 내뱉은 말이 비수가 되어 돌아올 수 있어. 그리고 스트레스를 받으면 낭비벽이 생길 수 있으니 지갑을 조심해.
            `,
            color: "#FF4081", char: "👑"
        },
        'fire-water': { // 수화기제
            title: "⚖️ 냉정과 열정 사이 (화+수)",
            desc: `
                <b>[융합 성격: 반전 매력의 천재]</b><br>
                불(화)과 물(수), 정반대의 성질을 다 가졌어! 🔥🌊 <br>
                어떨 땐 세상 뜨거운 열정맨이다가도, 어떨 땐 차갑고 냉소적으로 변하는 <b>'이중적인 매력'</b>이 있어. 이 두 에너지가 충돌하면서 엄청난 창의력과 예술적 영감이 쏟아져 나와. 평범함을 거부하는 독특한 캐릭터가 많아. 남들이 보지 못하는 이면을 꿰뚫어 보는 통찰력이 대단해.<br><br>
                <b>[행동 패턴]</b><br>
                순발력이 엄청나고 두뇌 회전이 빨라. 위기 상황을 기회로 바꾸는 능력이 있어. 즉흥적이고 감각적인 일에 능해.<br><br>
                <b>[주의할 점]</b><br>
                감정 기복이 롤러코스터급이야. 🎢 내면의 갈등 때문에 스스로가 괴로울 수 있어. 조급함을 버리고 마음의 평화를 찾는 명상이나 취미가 꼭 필요해.
            `,
            color: "#9575CD", char: "🎭"
        },
        'earth-metal': { // 토생금
            title: "💰 황금이 묻힌 광산 (토+금)",
            desc: `
                <b>[융합 성격: 실속파 알부자]</b><br>
                깊은 산(토) 속에 숨겨진 금맥(금)처럼 실속이 꽉 찼어. ⛰️💎 <br>
                '토'의 성실함과 '금'의 결실이 만나서 재물운이 아주 좋아. 겉멋보다는 실리를 추구하고, 묵묵히 내 할 일을 해서 기어코 결과를 만들어내는 <b>'성실한 천재'</b> 타입이야. 너는 허황된 꿈보다는 손에 잡히는 확실한 이익을 중요하게 생각해.<br><br>
                <b>[행동 패턴]</b><br>
                한 번 시작한 일은 끝을 보는 책임감이 있어. 신용을 중요하게 생각해서 주변의 평판이 좋아. 재테크나 사업 수완이 뛰어나서 경제적으로 풍요로울 확률이 높아. 🏦<br><br>
                <b>[주의할 점]</b><br>
                너무 계산적이라는 오해를 받을 수 있어. 🧮 인간관계에서도 손익을 따지다 보면 진정한 친구를 잃을 수 있어. 가끔은 손해 볼 줄도 아는 넉넉함이 더 큰 복을 불러올 거야!
            `,
            color: "#BCAAA4", char: "🏦"
        },
        'earth-water': { // 토극수
            title: "🚧 댐을 막은 호수 (토+수)",
            desc: `
                <b>[융합 성격: 철저한 전략가]</b><br>
                흙(토)으로 제방을 쌓아 물(수)을 조절하는 댐과 같아. ⛰️🌊 <br>
                넘치는 지혜(수)를 현실 감각(토)으로 통제하니 위기 관리 능력이 뛰어나고 처세술이 좋아. 겉으로는 사람 좋아 보이지만 머릿속으로는 득실을 정확하게 따지고 있는 <b>'현실주의자'</b>야. 어떤 난관이 와도 요리조리 피해가거나 해결해내는 능력이 있어.<br><br>
                <b>[행동 패턴]</b><br>
                조직 관리 능력이 뛰어나고 인내심이 강해. 비밀을 잘 지키고 입이 무거워서 참모 역할에 딱이야. 남을 조종하는 능력도 탁월해.<br><br>
                <b>[주의할 점]</b><br>
                너무 속내를 감추면 사람들이 다가오기 힘들어해. 🛡️ 의심이 많아서 기회를 놓칠 수도 있어. 때로는 계산기를 내려놓고 마음 가는 대로 행동해봐!
            `,
            color: "#546E7A", char: "🛡️"
        },
        'metal-water': { // 금수쌍청
            title: "❄️ 맑고 차가운 얼음물 (금+수)",
            desc: `
                <b>[융합 성격: 청렴결백한 논리왕]</b><br>
                바위(금) 틈에서 솟아나는 1급수(수)처럼 맑고 예리해. 💎🌊 <br>
                머리가 비상하고 논리적이라 말싸움이나 토론하면 절대 안 져. '금'의 결단력과 '수'의 유연함을 동시에 가져서 일 처리가 완벽 그 자체야. 학자, 판사, 연구원처럼 지적인 분야에서 두각을 나타내. 맑고 깨끗한 정신을 추구해서 도덕적이고 원칙을 잘 지켜.<br><br>
                <b>[행동 패턴]</b><br>
                기억력이 좋고 분석력이 뛰어나. 남들이 놓치는 디테일한 부분까지 잡아내는 능력이 있어. 감정보다는 이성적으로 판단해.<br><br>
                <b>[주의할 점]</b><br>
                너무 차가워 보여서 '냉혈한'이라는 오해를 받아. 🥶 남의 실수에 너무 엄격하게 굴지 말고, 따뜻한 말 한마디를 건네는 연습이 필요해. 너무 예민해서 신경성 질환을 조심해야 해.
            `,
            color: "#81D4FA", char: "🧊"
        }
    };

    /* 3. 3개 과다 복합 (10개) - 완전 세분화된 트리플 분석 */
    const TRIPLE_GUIDE = {
        'earth-fire-wood': { // 목생화생토 (순환상생)
            title: "🚀 거침없이 성장하는 대자연 (목+화+토)",
            desc: `
                <b>[성격 분석: 멈추지 않는 에너자이저]</b><br>
                목(시작) → 화(확산) → 토(기반)으로 이어지는 에너지가 막힘없이 흘러! 🌱🔥⛰️<br>
                너는 <b>'성장'</b> 그 자체야. '목'의 추진력으로 시작하고, '화'의 열정으로 불태우며, '토'의 끈기로 결과를 만들어내. 실패를 두려워하지 않는 무한 긍정의 아이콘이지. 어떤 일이든 맡겨만 주면 기어코 해내는 슈퍼 능력자!<br><br>
                <b>[장점 & 시너지]</b><br>
                실행력, 표현력, 마무리가 모두 완벽한 밸런스형 인재야. 주변 사람들을 이끄는 카리스마와 따뜻한 포용력을 동시에 가졌어.<br><br>
                <b>[주의할 점]</b><br>
                너무 앞만 보고 달리다가 건강을 챙기지 못할 수 있어. 💊 가끔은 멈춰 서서 뒤를 돌아보는 여유가 필요해.
            `,
            color: "#FF9800", char: "🌟"
        },
        'fire-metal-wood': { // 목생화, 화극금, 금극목 (역동적 변화)
            title: "⚔️ 세상을 바꾸는 혁명가 (목+화+금)",
            desc: `
                <b>[성격 분석: 카리스마 개혁가]</b><br>
                나무(목), 불(화), 도끼(금)가 만났다! 🌲🔥🗡️<br>
                기존의 틀을 부수고 새로운 것을 만들어내는 <b>'개혁가'</b> 기질이 다분해. '목'의 기획력, '화'의 쇼맨십, '금'의 결단력이 합쳐져서 엄청난 파괴력과 창조력을 동시에 발휘해. 지루한 건 딱 질색인 스펙터클한 인생의 주인공!<br><br>
                <b>[장점 & 시너지]</b><br>
                위기 상황에서 빛을 발하는 승부사야. 남들이 망설일 때 과감하게 결단하고 행동으로 옮겨. 리더로서 강력한 장악력이 있어.<br><br>
                <b>[주의할 점]</b><br>
                성격이 너무 급하고 독단적일 수 있어. 🔥 주변 사람들과 충돌이 잦을 수 있으니, "부드러움이 강함을 이긴다"는 말을 기억해!
            `,
            color: "#FF5252", char: "⚔️"
        },
        'fire-water-wood': { // 수생목, 목생화, 수극화 (감성과 지성)
            title: "🎨 감성 천재 아티스트 (목+화+수)",
            desc: `
                <b>[성격 분석: 감수성 풍부한 천재]</b><br>
                물(수)이 나무(목)를 키우고 꽃(화)을 피우는 형상이야. 🌊🌱🌸<br>
                감수성, 창의력, 표현력의 삼박자가 완벽해. '수'의 깊은 생각과 '목'의 순수함, '화'의 표현력이 만나 예술적 재능이 폭발해. 남들과 다른 독창적인 시각으로 세상을 보는 <b>'크리에이티브 천재'</b> 타입이야.<br><br>
                <b>[장점 & 시너지]</b><br>
                공감 능력이 뛰어나고 사람의 마음을 움직이는 힘이 있어. 작가, 예술가, 기획자로서 대성할 수 있는 잠재력이 무궁무진해.<br><br>
                <b>[주의할 점]</b><br>
                감정 기복이 심해서 우울감에 빠지기 쉬워. 😢 현실 감각이 조금 부족할 수 있으니, 뜬구름 잡는 생각만 하지 않도록 주의해!
            `,
            color: "#E040FB", char: "🎨"
        },
        'earth-metal-wood': { // 토생금, 금극목, 목극토 (현실적 성취)
            title: "🏗️ 기초가 튼튼한 건축가 (목+토+금)",
            desc: `
                <b>[성격 분석: 야망 있는 실력자]</b><br>
                재료(목)와 땅(토)과 도구(금)가 모두 갖춰졌어. 🌲⛰️🔨<br>
                현실적인 목표를 세우고(토), 철저하게 계획해서(목), 확실하게 결과(금)를 만들어내는 <b>'완벽주의 빌더'</b>야. 명예욕과 재물운을 동시에 쥐고 흔드는 강력한 사주지. 겉으로는 젠틀해 보여도 속엔 엄청난 야망이 꿈틀대고 있어.<br><br>
                <b>[장점 & 시너지]</b><br>
                일 처리가 빈틈없고 신뢰감이 높아. 조직 생활에 최적화되어 있고, 승진도 빠르고 돈도 잘 모으는 알짜배기 인생이야. 💰<br><br>
                <b>[주의할 점]</b><br>
                너무 계산적이고 인간미 없다는 소리를 들을 수 있어. 🤖 성공도 좋지만 주변 사람을 챙기는 따뜻함을 잊지 마.
            `,
            color: "#795548", char: "🏗️"
        },
        'earth-water-wood': { // 수생목, 목극토, 토극수 (생존력)
            title: "🌱 척박한 땅의 생명력 (목+토+수)",
            desc: `
                <b>[성격 분석: 외유내강 끝판왕]</b><br>
                물(수)과 흙(토) 사이에서 끈질기게 자라나는 나무(목)야. 🌊⛰️🌱<br>
                어떤 악조건 속에서도 살아남는 <b>'잡초 같은 생명력'</b>을 가졌어. '수'의 지혜로 위기를 넘기고, '토'의 인내심으로 버티며, '목'의 의지로 결국엔 꽃을 피워내. 겉으로는 유순해 보이지만 멘탈이 다이아몬드처럼 단단해.<br><br>
                <b>[장점 & 시너지]</b><br>
                적응력이 뛰어나고 처세술이 좋아. 사람을 다루는 능력이 탁월해서 교육자나 인사 관리자, 상담가로 아주 좋아.<br><br>
                <b>[주의할 점]</b><br>
                속을 알 수 없는 사람이야. 😶 생각이 너무 많아서 행동이 느릴 수 있고, 의심이 많아서 기회를 놓칠 수 있으니 과감함이 필요해!
            `,
            color: "#00695C", char: "🌵"
        },
        'metal-water-wood': { // 금생수, 수생목, 금극목 (지적 능력)
            title: "⚖️ 냉철한 전략기획가 (목+금+수)",
            desc: `
                <b>[성격 분석: 차가운 머리와 뜨거운 가슴]</b><br>
                도끼(금)로 다듬고, 물(수)로 씻어낸 깨끗한 나무(목)야. 💎🌊🌲<br>
                논리(금)와 지혜(수)와 기획력(목)이 합쳐진 <b>'지능형 리더'</b>야. 감정에 휘둘리지 않고 이성적으로 판단하면서도, 미래를 내다보는 혜안을 가졌어. 학자, 연구원, 고위 공직자 등 '머리 쓰는 일'에 특화되어 있지.<br><br>
                <b>[장점 & 시너지]</b><br>
                원칙을 지키면서도 융통성을 발휘할 줄 알아. 분석력과 창의력을 동시에 갖춘 보기 드문 인재야. 🧠<br><br>
                <b>[주의할 점]</b><br>
                너무 비판적이고 날카로울 수 있어. 🔪 남의 결점을 지적하기보다는 장점을 봐주는 너그러움이 필요해. 신경이 예민해서 불면증 조심!
            `,
            color: "#0288D1", char: "⚖️"
        },
        'earth-fire-metal': { // 화생토, 토생금, 화극금 (부와 명예)
            title: "🏭 거대한 제철소 (화+토+금)",
            desc: `
                <b>[성격 분석: 스케일 큰 사업가]</b><br>
                불(화)과 흙(토)과 쇠(금)가 모였으니 거대한 공장과 같아. 🔥⛰️🏭<br>
                스케일이 크고 배포가 두둑한 <b>'대장부'</b> 스타일이야. '화'의 리더십으로 사람을 모으고, '토'의 신용으로 자본을 모아, '금'의 결실을 만들어내. 작은 일에 연연하지 않고 큰 그림을 그리는 능력이 탁월해.<br><br>
                <b>[장점 & 시너지]</b><br>
                실행력과 관리 능력이 모두 좋아. 재물운이 강력하고, 조직을 이끄는 보스 기질이 있어서 사업가로 대성할 확률이 높아. 👑<br><br>
                <b>[주의할 점]</b><br>
                독단적이고 권위적일 수 있어. 내 뜻대로 안 되면 불같이 화를 내기도 해. 아랫사람들의 의견을 경청하는 자세가 성공의 열쇠야.
            `,
            color: "#D84315", char: "🏭"
        },
        'earth-fire-water': { // 수극화, 화생토, 토극수 (복잡미묘)
            title: "⛈️ 비 내리는 화산 (화+토+수)",
            desc: `
                <b>[성격 분석: 감성적인 리더]</b><br>
                뜨거운 불(화)과 차가운 물(수)이 대지(토) 위에서 만났어. 🔥🌊⛰️<br>
                열정과 냉정, 그리고 현실 감각을 모두 갖춘 <b>'복합적인 캐릭터'</b>야. 상황 파악이 빠르고 사람의 심리를 잘 이용하여 원하는 것을 얻어내. 직관력이 뛰어나서 남들이 못 보는 기회를 잡아내는 능력이 있어.<br><br>
                <b>[장점 & 시너지]</b><br>
                임기응변이 뛰어나고 매력이 넘쳐. 인기를 얻는 법과 돈을 버는 법을 본능적으로 알고 있어.<br><br>
                <b>[주의할 점]</b><br>
                변덕이 죽 끓듯 해. 🍲 감정 컨트롤이 안 되면 주변 사람들을 힘들게 할 수 있어. 한 가지 일에 집중하지 못하고 이것저것 벌이다가 흐지부지될 수 있으니 주의해.
            `,
            color: "#5E35B1", char: "⛈️"
        },
        'fire-metal-water': { // 수극화, 화극금, 금생수 (혁신과 충돌)
            title: "⚡ 폭풍우 치는 밤의 번개 (화+금+수)",
            desc: `
                <b>[성격 분석: 급진적인 혁명가]</b><br>
                불(화), 물(수), 쇠(금) 등 강한 기운들이 부딪히는 형상이야! 🔥🌊⚡<br>
                평범함을 거부하고 끊임없이 변화를 추구하는 <b>'혁명가'</b> 기질이 있어. 에너지가 폭발적이고 두뇌 회전이 빛의 속도야. 남들보다 시대를 앞서가는 감각이 있어서 트렌드세터나 발명가가 많아.<br><br>
                <b>[장점 & 시너지]</b><br>
                순발력과 돌파력이 타의 추종을 불허해. 불가능해 보이는 일도 기어코 해내는 깡다구가 있어. 💪<br><br>
                <b>[주의할 점]</b><br>
                인생이 다이나믹해. 🎢 사고수가 있거나 인간관계의 단절이 있을 수 있어. 성격을 좀 죽이고 차분하게 생각하는 습관을 들이면 대성할 거야.
            `,
            color: "#303F9F", char: "⚡"
        },
        'earth-metal-water': { // 토생금, 금생수, 토극수 (실리 추구)
            title: "💎 보석이 숨겨진 호수 (토+금+수)",
            desc: `
                <b>[성격 분석: 실속 챙기는 전략가]</b><br>
                땅(토)이 금(금)을 낳고, 금이 물(수)을 낳는 상생의 흐름이야. ⛰️💎🌊<br>
                지극히 <b>'현실적이고 실리적인'</b> 사람이야. 감정에 휘둘리지 않고 철저하게 이익을 계산해서 움직여. 머리가 좋고(수), 일 처리가 깔끔하며(금), 인내심(토)까지 있으니 부자가 안 될 수가 없지.<br><br>
                <b>[장점 & 시너지]</b><br>
                재물복이 타고났어. 💰 안정적이면서도 꾸준하게 자산을 불려나가는 능력이 있어. 말보다는 행동으로 보여주는 신뢰받는 사람이야.<br><br>
                <b>[주의할 점]</b><br>
                너무 냉정하고 계산적이야. ❄️ 인간미가 없어서 외로울 수 있어. 돈도 좋지만 사람의 마음을 얻는 법을 배워야 진정한 행복을 누릴 수 있어.
            `,
            color: "#455A64", char: "💎"
        }
    };

     /* [4. ★NEW★ 약한 기운 2개 융합 (Weak Pair) - 결핍 분석 상세] */
    const WEAK_PAIR_GUIDE = {
        'fire-wood': { // 목, 화 부족
            title: "❄️ 꽁꽁 언 시베리아 (목&화 부족)",
            desc: "<b>[문제점: 의욕 상실 & 무기력]</b><br>시동 거는 힘(목)도 없고, 태우는 불(화)도 없으니 엔진이 멈춘 상태야. 🥶 매사에 의욕이 없고 '귀찮아'를 입에 달고 살아. 우울감이 쉽게 찾아오고, 긍정적인 에너지가 턱없이 부족해. 차가운 이성보다는 뜨거운 감성이 필요해!",
            sol: "활동적인 운동, 밝은 옷 입기, 햇볕 쬐기"
        },
        'earth-wood': { // 목, 토 부족
            title: "🍃 바람에 날리는 먼지 (목&토 부족)",
            desc: "<b>[문제점: 정체성 혼란 & 불안]</b><br>자아를 세우는 힘(목)과 지탱하는 힘(토)이 둘 다 없어. 🌫️ 내가 뭘 좋아하는지, 어디로 가야 할지 몰라 방황하는 영혼이야. 끈기가 없어서 이것저것 건드려만 보고 포기가 빨라. 뿌리가 얕아서 작은 시련에도 쉽게 흔들려.",
            sol: "등산, 맨발 걷기, 작은 목표 달성하기"
        },
        'metal-wood': { // 목, 금 부족
            title: "😶 우유부단한 갈대 (목&금 부족)",
            desc: "<b>[문제점: 결정 장애 & 실행 불가]</b><br>시작(목)도 못 하고 끝맺음(금)도 못 해. 🤔 하루 종일 고민만 하다가 타이밍을 다 놓쳐. 남에게 싫은 소리를 못 해서 질질 끌려다니기 쉬워. 맺고 끊는 게 약해서 실속을 챙기기 어려워.",
            sol: "거절하는 연습, 금속 액세서리, 스케줄 정리"
        },
        'water-wood': { // 목, 수 부족
            title: "🥀 말라버린 화초 (목&수 부족)",
            desc: "<b>[문제점: 융통성 부족 & 고지식]</b><br>유연한 사고(수)와 성장 욕구(목)가 부족해. 🍂 생각이 고여 있어서 꼰대 소리를 들을 수 있고, 새로운 변화를 두려워해. 감정이 메말라 있어서 타인의 감정에 공감하기 어려울 수 있어. 너무 현실에만 안주하려고 해.",
            sol: "독서, 반신욕, 수족관 구경, 인문학 공부"
        },
        'earth-fire': { // 화, 토 부족
            title: "🌫️ 차가운 허공 (화&토 부족)",
            desc: "<b>[문제점: 현실 감각 제로 & 고립]</b><br>따뜻한 사랑(화)과 믿음(토)이 부족해. 😶 사람들을 만나는 걸 꺼리고 혼자만의 세계에 갇히기 쉬워. 현실 감각이 떨어져서 뜬구름 잡는 소리를 할 때가 많아. 주변 사람들에게 무관심해서 고립될 수 있어.",
            sol: "동호회 활동, 황토 찜질, 매운 음식 먹기"
        },
        'fire-metal': { // 화, 금 부족
            title: "😐 무미건조한 로봇 (화&금 부족)",
            desc: "<b>[문제점: 표현력 부족 & 맺고 끊기 실패]</b><br>화려함(화)도 없고 확실함(금)도 없어. 🤖 인생이 재미없고 지루하게 느껴질 수 있어. 감정 표현이 서툴러서 연애가 힘들고, 일에 있어서도 임팩트가 부족해. 너무 무난하게만 살려고 해서 매력이 반감될 수 있어.",
            sol: "화려한 패션 도전, 노래방 가기, 자기주장 하기"
        },
        'fire-water': { // 화, 수 부족
            title: "🏜️ 건조한 사막 (화&수 부족)",
            desc: "<b>[문제점: 감수성 부족 & 삭막함]</b><br>열정(화)도 지혜(수)도 부족해. 🐪 삶이 퍽퍽하고 여유가 없어. 눈치가 없어서 분위기 파악을 못 하거나, 센스 없다는 소리를 들을 수 있어. 즐거움을 느끼는 감각이 무뎌져 있어서 삶이 건조해.",
            sol: "여행, 영화 감상, 붉은색/검은색 코디"
        },
        'earth-metal': { // 토, 금 부족
            title: "🏚️ 기둥 없는 집 (토&금 부족)",
            desc: "<b>[문제점: 신뢰 부족 & 결실 없음]</b><br>묵직함(토)과 단단함(금)이 없어. 🏚️ 약속을 잘 어기거나 책임감이 부족해 보일 수 있어. 열심히 하긴 하는데 결과물이 안 나와서 속상한 타입. 마무리가 약해서 다 된 밥에 재 뿌릴 수 있어.",
            sol: "저축하기, 약속 칼같이 지키기, 근력 운동"
        },
        'earth-water': { // 토, 수 부족
            title: "🛶 표류하는 쪽배 (토&수 부족)",
            desc: "<b>[문제점: 불안정 & 임기응변 불가]</b><br>안정감(토)과 유연함(수)이 없어. 🌊 파도 치는 대로 휩쓸려 다니는 인생이야. 위기 상황이 오면 멘탈이 와르르 무너져버려. 자기 주관이 뚜렷하지 않아서 남들의 의견에 쉽게 휩쓸려.",
            sol: "명상, 요가, 산책, 멘토 찾기"
        },
        'metal-water': { // 금, 수 부족
            title: "🧩 논리 없는 고집 (금&수 부족)",
            desc: "<b>[문제점: 판단력 흐림 & 무계획]</b><br>이성적 판단(금)과 지혜(수)가 부족해. 🤪 기분에 따라 즉흥적으로 행동하다가 손해를 많이 봐. 논리가 부족해서 말싸움하면 지고, 남의 말에 잘 속아 넘어가는 팔랑귀야.",
            sol: "가계부 쓰기, 바둑/체스, 흰색/검은색 코디"
        }
    };

    const HANJA_TO_KOR = {'甲':'갑','乙':'을','丙':'병','丁':'정','戊':'무','己':'기','庚':'경','辛':'신','壬':'임','癸':'계','子':'자','丑':'축','寅':'인','卯':'묘','辰':'진','巳':'사','午':'오','未':'미','申':'신','酉':'유','戌':'술','亥':'해'};
    const JIJANGGAN_MAP = {'子': ['water'], '丑': ['water', 'metal', 'earth'], '寅': ['earth', 'fire', 'wood'], '卯': ['wood'], '辰': ['wood', 'water', 'earth'], '巳': ['earth', 'metal', 'fire'], '午': ['fire', 'earth'], '未': ['fire', 'wood', 'earth'], '申': ['earth', 'water', 'metal'], '酉': ['metal'], '戌': ['metal', 'fire', 'earth'], '亥': ['earth', 'wood', 'water']};
    const GAN_MAP = {'甲':'wood','乙':'wood','丙':'fire','丁':'fire','戊':'earth','己':'earth','庚':'metal','辛':'metal','壬':'water','癸':'water'};
    const JI_MAP = {'寅':'wood','卯':'wood','巳':'fire','午':'fire','辰':'earth','戌':'earth','丑':'earth','未':'earth','申':'metal','酉':'metal','亥':'water','子':'water'};

    let calType = 'solar';
    let myChart = null;

    window.onload = function() {
        const ySel = document.getElementById('sel-year'); for(let i=2024; i>=1950; i--) ySel.add(new Option(i+'년', i)); ySel.value = 1996;
        const mSel = document.getElementById('sel-month'); for(let i=1; i<=12; i++) mSel.add(new Option(i+'월', i));
        const dSel = document.getElementById('sel-day'); for(let i=1; i<=31; i++) dSel.add(new Option(i+'일', i));
    };
    function setCal(t) { calType = t; document.getElementById('btn-solar').className=t=='solar'?'toggle-btn active':'toggle-btn'; document.getElementById('btn-lunar').className=t=='lunar'?'toggle-btn active':'toggle-btn'; }
    function nav(id) { document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0,0); }

 function processResult() {
        nav('p-loading');
        setTimeout(() => {
            const y=parseInt(document.getElementById('sel-year').value), m=parseInt(document.getElementById('sel-month').value), d=parseInt(document.getElementById('sel-day').value), t=parseInt(document.getElementById('sel-time').value);
            
            // 시간 계산용: 모름(99)일 경우 날짜 계산을 위해 임시로 12시로 설정하지만,
            // 아래 분석 로직에서는 제외할 예정임
            let timeForCalc = (t === 99) ? 12 : t;

            let ld = calType=='solar' ? Solar.fromYmdHms(y,m,d,timeForCalc,0,0).getLunar() : Lunar.fromYmdHms(y,m,d,timeForCalc,0,0);
            const bazi = { y:ld.getYearInGanZhi(), m:ld.getMonthInGanZhi(), d:ld.getDayInGanZhi(), t:ld.getTimeInGanZhi() };
            
            let cnt = {wood:0, fire:0, earth:0, metal:0, water:0};
            
            // [수정됨] 분석할 기둥 목록 만들기
            let pillarsToCheck = [bazi.y, bazi.m, bazi.d]; // 연, 월, 일은 무조건 포함
            
            // ★ 중요: 시간이 '모름(99)'이 아닐 때만 시주(bazi.t)를 추가함!
            if (t !== 99) {
                pillarsToCheck.push(bazi.t);
            }

            let branchList = [];

            // 위에서 만든 목록(pillarsToCheck)으로만 오행 카운트
            pillarsToCheck.forEach((col) => {
                const gan = GAN_MAP[col[0]];
                const ji = JI_MAP[col[1]];
                if(gan) cnt[gan] += 1;
                if(ji) cnt[ji] += 1;
                branchList.push(col[1]);
            });

            // 지장간 분석도 '모름'일 땐 시지(시간의 지지)가 빠지므로 자동으로 제외됨
            branchList.forEach(ji => {
                const hiddenElems = JIJANGGAN_MAP[ji];
                if(hiddenElems) { hiddenElems.forEach(elem => cnt[elem] += 0.5); }
            });

            analyze(bazi.d[0], bazi.d[1], cnt);
            nav('p-result');
        }, 3000);
    }

    function analyze(ilgan, ilji, cnt) {
        document.getElementById('my-ilju').innerText = HANJA_TO_KOR[ilgan] + HANJA_TO_KOR[ilji] + "일주";
        const keys = ['wood', 'fire', 'earth', 'metal', 'water'];
        
        // --- 1. 과다(Strong) 분석 ---
        let sortedMax = [...keys].sort((a,b) => cnt[b] - cnt[a]);
        let k1 = sortedMax[0], k2 = sortedMax[1], k3 = sortedMax[2];
        let v1 = cnt[k1], v2 = cnt[k2], v3 = cnt[k3];
        let isTriple = (v1 === v2 && v2 === v3);
        let isDouble = (v1 === v2 && !isTriple);

        let mainChar, mainName, mainDescShort, highTitle, highDesc, mainColor;
        let luckyColorStr = "", luckyItemStr = "";

        if (isTriple) { // 3개 과다
            let tKey = [k1, k2, k3].sort().join('-');
            const data = TRIPLE_GUIDE[tKey];
            mainChar = `<span style="font-size:50px;">${data.char}</span>`;
            mainName = data.title.split('(')[0]; 
            mainDescShort = "세 가지 기운의 완벽한 밸런스";
            mainColor = data.color;
            highTitle = data.title;
            highDesc = `<div style="text-align:left; line-height:1.6;">${data.desc}</div>`;
            
            const d1=SINGLE_GUIDE[k1], d2=SINGLE_GUIDE[k2], d3=SINGLE_GUIDE[k3];
            luckyColorStr = `${d1.lucky.color.split(',')[0]}, ${d2.lucky.color.split(',')[0]}, ${d3.lucky.color.split(',')[0]}`;
            luckyItemStr = `${d1.lucky.item.split(',')[0]}, ${d2.lucky.item.split(',')[0]}, ${d3.lucky.item.split(',')[0]}`;

        } else if (isDouble) { // 2개 과다
            let pKey = [k1, k2].sort().join('-');
            const data = PAIR_GUIDE[pKey];
            mainChar = `<span style="font-size:50px;">${data.char}</span>`;
            mainName = data.title.split('(')[0];
            mainDescShort = `${SINGLE_GUIDE[k1].name} & ${SINGLE_GUIDE[k2].name} 융합형`;
            mainColor = data.color;
            highTitle = data.title;
            highDesc = `<div style="text-align:left; line-height:1.6;">${data.desc}</div>`;
            
            const d1=SINGLE_GUIDE[k1], d2=SINGLE_GUIDE[k2];
            luckyColorStr = `${d1.lucky.color.split(',')[0]}, ${d2.lucky.color.split(',')[0]}`;
            luckyItemStr = `${d1.lucky.item.split(',')[0]}, ${d2.lucky.item.split(',')[0]}`;

        } else { // 1개 과다
            const data = SINGLE_GUIDE[k1];
            mainChar = `<span style="font-size:50px;">${data.char}</span>`;
            mainName = data.name + "형";
            mainDescShort = data.name + " 에너지가 메인이야!";
            mainColor = data.color;
            highTitle = `${data.name} : ${data.title}`;
            highDesc = `<div style="text-align:left; line-height:1.6;">${data.desc}</div>`;
            luckyColorStr = data.lucky.color;
            luckyItemStr = data.lucky.item;
        }

        // DOM Update (Strong)
        document.getElementById('main-char').innerHTML = mainChar;
        document.getElementById('main-name').innerText = mainName;
        document.getElementById('main-el-circle').style.border = "none";
        document.getElementById('main-el-circle').style.boxShadow = `0 5px 20px ${mainColor}66`;
        document.getElementById('main-desc-short').innerText = mainDescShort;
        document.getElementById('main-desc-short').style.color = mainColor;
        document.getElementById('res-max-title').innerHTML = highTitle;
        document.getElementById('res-max-desc').innerHTML = highDesc;


        // --- 2. 부족(Weak) 분석 ---
        let sortedMin = [...keys].sort((a,b) => cnt[a] - cnt[b]);
        let m1 = sortedMin[0], m2 = sortedMin[1], m3 = sortedMin[2];
        let minV1 = cnt[m1], minV2 = cnt[m2], minV3 = cnt[m3];
        
        let minTriple = (minV1 === minV2 && minV2 === minV3);
        let minDouble = (minV1 === minV2 && !minTriple);
        
        let minTitlePrefix = (minV1 === 0) ? "💧 나의 부족 에너지 (결핍)" : "💪 상대적으로 약한 기운";
        document.getElementById('min-card-head').innerText = minTitlePrefix;

        if (minTriple) { // 3개 부족
            document.getElementById('res-min-title').innerHTML = "🚨 3가지 기운 긴급 충전 요망";
            document.getElementById('res-min-desc').innerHTML = `
                <div style="text-align:left;">
                    <p style="margin-bottom:10px;">이 세 가지 기운이 동시에 부족해서 밸런스가 많이 무너져 있어.</p>
                    <div style="background:#fff; padding:10px; border-radius:10px; margin-bottom:5px; border:1px solid #eee;">
                        <b>1. ${SINGLE_GUIDE[m1].name}</b> : ${SINGLE_GUIDE[m1].lowDesc.replace("<b>[결핍 분석]</b>", "")}
                    </div>
                    <div style="background:#fff; padding:10px; border-radius:10px; margin-bottom:5px; border:1px solid #eee;">
                        <b>2. ${SINGLE_GUIDE[m2].name}</b> : ${SINGLE_GUIDE[m2].lowDesc.replace("<b>[결핍 분석]</b>", "")}
                    </div>
                    <div style="background:#fff; padding:10px; border-radius:10px; border:1px solid #eee;">
                        <b>3. ${SINGLE_GUIDE[m3].name}</b> : ${SINGLE_GUIDE[m3].lowDesc.replace("<b>[결핍 분석]</b>", "")}
                    </div>
                </div>
            `;
            document.getElementById('lucky-color').innerText = `${SINGLE_GUIDE[m1].lucky.color.split(',')[0]}, ${SINGLE_GUIDE[m2].lucky.color.split(',')[0]}, ${SINGLE_GUIDE[m3].lucky.color.split(',')[0]}`;
            document.getElementById('lucky-item').innerText = "부족한 기운의 아이템을 골고루!";

        } else if (minDouble) { // 2개 부족 (WEAK_PAIR_GUIDE 사용)
            let pKey = [m1, m2].sort().join('-');
            const data = WEAK_PAIR_GUIDE[pKey];
            
            document.getElementById('res-min-title').innerHTML = data.title;
            document.getElementById('res-min-desc').innerHTML = `
                <div style="text-align:left; line-height:1.6;">
                    ${data.desc}<br><br>
                    <div style="background:#E0F7FA; padding:10px; border-radius:10px; font-weight:bold; color:#006064; text-align:center;">
                        💡 해결책: ${data.sol}
                    </div>
                </div>
            `;
            const md1=SINGLE_GUIDE[m1], md2=SINGLE_GUIDE[m2];
            document.getElementById('lucky-color').innerText = `${md1.lucky.color.split(',')[0]}, ${md2.lucky.color.split(',')[0]}`;
            document.getElementById('lucky-item').innerText = `${md1.lucky.item.split(',')[0]}, ${md2.lucky.item.split(',')[0]}`;

        } else { // 1개 부족
            const data = SINGLE_GUIDE[m1];
            document.getElementById('res-min-title').innerHTML = `${data.name} : ${data.lowTitle}`;
            document.getElementById('res-min-desc').innerHTML = `
                <div style="text-align:left; line-height:1.6;">${data.lowDesc}</div>
            `;
            document.getElementById('lucky-color').innerText = data.lucky.color;
            document.getElementById('lucky-item').innerText = data.lucky.item;
        }

        // Chart Update
        const ctx = document.getElementById('elementChart').getContext('2d');
        if(myChart) myChart.destroy();
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['목', '화', '토', '금', '수'],
                datasets: [{
                    label: '에너지 점수',
                    data: [cnt.wood, cnt.fire, cnt.earth, cnt.metal, cnt.water],
                    backgroundColor: [SINGLE_GUIDE.wood.color, SINGLE_GUIDE.fire.color, SINGLE_GUIDE.earth.color, SINGLE_GUIDE.metal.color, SINGLE_GUIDE.water.color],
                    borderColor: 'transparent', borderWidth: 0, borderRadius: 8, borderSkipped: false
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, max: Math.max(...Object.values(cnt)) + 1, ticks: { color:'#777', font:{weight:'bold'} }, grid: { color: '#eee', borderDash: [5, 5] } },
                    x: { grid: { display: false }, ticks: { color:'#777', font:{weight:'bold'} } }
                }
            }
        });
    }
function saveImage() {
        const captureArea = document.getElementById('capture-area');
        
        // 1. 캡쳐 영역이 잘 보이도록 스크롤을 맨 위로 이동 (렌더링 오류 방지)
        window.scrollTo(0,0); 
        captureArea.classList.add('snapshot-mode');

        // 2. 캡쳐 시작
        html2canvas(captureArea, { 
            scale: 2, // 3은 너무 커서 모바일에서 튕길 수 있음 -> 2로 조정
            backgroundColor: "#ffffff", // 배경 흰색 고정
            useCORS: true, // 외부 이미지(로고 등) 허용
            allowTaint: true, // 로컬 이미지 오염 허용
            logging: true // 에러 확인용 로그
        }).then(canvas => {
            const link = document.createElement('a');
            link.download = '하이틴_오행분석_결과.png';
            
            // 이미지 데이터 변환
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            // 3. 캡쳐 모드 해제
            captureArea.classList.remove('snapshot-mode');
        }).catch(err => {
            console.error("캡쳐 에러:", err);
            alert("이미지 저장에 실패했어요 😢\n(PC에서 바로 열었다면 보안 문제일 수 있어요. 웹 서버에 올리면 작동합니다!)");
            captureArea.classList.remove('snapshot-mode');
        });
    }
   document.addEventListener("DOMContentLoaded", function () {
        const shareButton = document.getElementById("share-btn"); // 공유 버튼 선택
        if (shareButton) {
            shareButton.addEventListener("click", function () {
                const testURL = window.location.href; // 현재 페이지 URL 가져오기
                const shareText = "테스트잇 사주 오행 성격 테스트"; 

                if (navigator.share) {
                    // 📱 모바일 및 지원되는 브라우저에서 기본 공유 기능 사용
                    navigator.share({
                        title: "테스트잇 사주 오행 성격 테스트", 
                        text: shareText,
                        url: testURL
                    }).then(() => {
                        console.log("✅ 공유 성공!");
                    }).catch((error) => {
                        console.error("❌ 공유 실패:", error);
                    });
                } else {
                    // 💻 PC에서는 클립보드에 복사
                    navigator.clipboard.writeText(`${shareText} ${testURL}`).then(() => {
                        alert("📌 링크가 복사되었습니다! 친구들에게 공유해보세요.");
                    }).catch((err) => {
                        console.error("❌ 클립보드 복사 실패:", err);
                    });
                }
            });
        }
    });
    
</script>
</body>
</html>
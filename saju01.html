

<!DOCTYPE html>
<html lang="ko">
<head>

     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5522499110435321"
     crossorigin="anonymous"></script>
     <meta http-equiv="Content-Security-Policy" content="
     default-src 'self' https://*;
     script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*;
     style-src 'self' 'unsafe-inline' https://*;
     img-src 'self' data: https://*;
     connect-src 'self' https://*;
     frame-src 'self' https://*;
     ">
     <script src="https://nsp.pay.naver.com/sdk/js/naverpay.min.js"></script>

     <script src="https://js.tosspayments.com/v2/standard"></script>









    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>테스트잇 정통 사주 리포트</title>
    <meta name="description" content="테스트잇 정통 사주 리포트">
<meta name="keywords" content="테스트잇,전체사주,정통사주,테스트잇사주,테스트잇전체사주,테스트잇사주,정확한사주,연애테스트,연애mbti,연애성격테스트, 심리테스트, mbti테스트">
    <meta property="og:type" content="website"> 
    <meta property="og:title" content="테스트잇 정통 사주 리포트">
    <meta property="og:description" content="테스트잇 정통 사주 리포트">
    <meta property="og:image" content="saju_main01.png">
    <meta property="og:url" content="https://test-it.co.kr/saju01">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
      <link rel="icon" type="image/png" href="favicon.png">
<link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap" rel="stylesheet">




<style>

/* start 태그와 question 태그 모두 article 태그라서 article 태그에 속성을 주면 동시에 적용됨
.start{
    display: flex;
    flex-direction: column;
}
*/
    
   @font-face {
    font-family: 'ChosunGu';
    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@1.0/ChosunGu.woff') format('woff');
    font-weight: normal;
    font-style: normal;
}
    
      body {
            font-family: 'ChosunGu', sans-serif;
        }
    
.logo {
    width: 100px;
    margin-top: 14px;
}

.main-nav {
    display: flex;
    font-size: 1.25rem;
    text-transform: uppercase;
    margin-top: 34px;
    list-style: none;
}

.main-nav li {
    margin-left: 36px;
       font-family: 'Do Hyeon', sans-serif;
    line-height: 1.7;
    color: #432;
}

.main-nav a{
    color: #432;
       font-family: 'Do Hyeon', sans-serif;
    line-height: 1.7;
}

.main-nav a:hover {
    color: #0bd;
}


.page-header {
    display: flex;
    justify-content: space-between;
}

    
article{
    display: flex;
    flex-direction: column;
}

 
    
#img{
    width: 500px;
    height: 900px;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}

#img_main{
    width: 500px;
    height: 600px;
    max-width: 100%;
    height: auto;
    margin: 0 auto;
}


.custom-jelly-button {
    width: 100%;
    max-width: 350px;
    height: 60px;
    font-size: 15px !important;
    font-weight: bold;
    color: black !important;
    background: linear-gradient(145deg, #ffcfcf, #ffcfcf); /* 분홍과 노랑 그라데이션 */
    border: none;
    border-radius: 17px;
    box-shadow: inset -4px -4px 10px rgba(255, 255, 255, 0.7), 
                inset 4px 4px 10px rgba(0, 0, 0, 0.1),
                2px 2px 8px rgba(0, 0, 0, 0.15);
    margin: 0 auto;
    display: block;
}

.custom-jelly-button:hover {
    background: linear-gradient(145deg, #ffcfcf, #ffcfcf); /* 반대로 그라데이션 */
}


/* 페이지 기본 스타일 */
  /* 페이지 기본 스타일 */
  .page {
      display: none;
      margin: 0 auto;
      max-width: 600px;
      padding: 20px;
      background-color: #fff;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .page.active {
      display: block;
    }

    /* 정보 입력 페이지 전체 스타일 */
    .info-page {
      text-align: center;
    }

    /* "사주 정보 입력" 제목 스타일 (크기는 살짝 작게, 굵게) */
    .info-title {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 10px; /* 제목 아래 간격 */
    }

    /* 폼 전체 스타일: 세로 레이아웃 + 중앙 정렬 + 요소 간격 */
    .saju-form {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px; /* 폼 내부 요소 간격(줄임) */
      margin: 0 auto;
      max-width: 400px; /* 폼 자체 폭 제한 */
    }

    /* 각 입력 그룹(이름, 성별, 생년월일, 태어난 시간, 이메일) 공통 스타일 */
    .form-group {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 3px; /* 레이블과 입력창 사이 간격(더 줄임) */
    }

    /* 레이블 굵게 */
    .label-bold {
      font-weight: bold;
    }

    /* 단일 input, select 공통 스타일 (너비 100%) */
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ddd;
    }

    /* 생년월일(양력/음력 + 연/월/일)을 한 줄로 배치할 때 사용하는 컨테이너 */
    .form-group-inline {
      display: flex;
      flex-direction: row;
      gap: 8px; /* 드롭다운 사이 간격 */
      width: 100%;
    }

    /* 이 컨테이너 안의 select들을 동일한 비율로 늘려 같은 폭을 맞춤 */
    .form-group-inline select {
      flex: 1;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ddd;
    }

    /* 버튼 영역(결제하기/돌아가기) */
    .button-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      width: 100%;
      max-width: 500px;
    }

/* 결제 페이지 스타일 */
.payment-page {
  text-align: center; /* 페이지 전체 중앙 정렬 */
}

/* 결제 진행 메인 제목 */
.payment-page h1 {
  font-size: 1.2rem;  /* 글씨 크기 조금 줄임 */
  font-weight: bold;
  margin-bottom: 10px; /* 아래쪽 여백 */
}

/* "입력 정보 확인" 등 하위 제목 */
.payment-page h2 {
  font-size: 1rem;    /* 더 작게 */
  font-weight: bold;
  margin-bottom: 8px;
}

/* 일반 텍스트(이름, 생년월일, 태어난 시간, 이메일 등) */
.payment-page p {
  font-size: 0.9rem;  /* 일반 텍스트 크기 */
  margin-bottom: 5px;
}

    
    .at-share-btn-elements{
        text-align: center;
    }
.share{
    margin: 0 auto;
}

.coupang_ad {
    width: 320px;
    margin: 0 auto;
}
        .custom-button {
            width: 100%;
            max-width: 350px;
            margin: 0 auto;
        }
    
        input, select, button {
      width: 80%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #ddd;
    }
    
    
</style>





</head>
<!-- body 태그 style background-color 지정으로 배경색 변경-->
<body class="container" style="background-color:#ffffff">
            
    <header class="page-header wrapper">
        <h1><a href="index.html"><img class="logo" src="img_logo.png" alt="test it"></a>
        </h1>
    <nav>
        <u1 class="main-nav">
            <li> <a href="https://test-it.co.kr/test.html">성격</a></li>
            <li> <a href="https://test-it.co.kr/face.html">얼굴</a></li>
            <li> <a href="https://test-it.co.kr/etc.html">그외</a></li>
            <li> <a href="https://test-it.co.kr/saju.html">사주</a></li>
        </u1>
    </nav>
        
        
    </header>

  <!-- 1. 사주 메인 페이지 -->
  <div id="mainPage" class="page active">
    <img src="saju_main01.png" alt="사주 예시" style="width: 100%; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
    <br><br>
    <button class="custom-jelly-button" onclick="showPage('infoPage')">💌 정보 입력하고 결제하기</button>
</div>

  <!-- 정보 입력 페이지 -->
  <div id="infoPage" class="page info-page">
    <h1 class="info-title">📄 사주 정보 입력</h1>

    <form id="sajuForm" class="saju-form">
      <!-- 이름 -->
      <div class="form-group">
        <input
          type="text"
          id="userName"
          placeholder="이름 (예: 홍길동)"
          required
        />
      </div>

      <!-- 성별 -->
      <div class="form-group">
        <label for="userGender" class="label-bold">성별</label>
        <select id="userGender" required>
          <option value="여성">여성</option>
          <option value="남성">남성</option>
        </select>
      </div>

      <!-- 생년월일 (양력/음력 + 연/월/일) -->
      <div class="form-group">
        <label for="birthType" class="label-bold">생년월일</label>
        <div class="form-group-inline">
          <!-- 양력/음력 -->
          <select id="birthType" required>
            <option value="양력">양력</option>
            <option value="음력">음력</option>
          </select>
          <!-- 연/월/일 -->
          <select id="birthYear" required></select>
          <select id="birthMonth" required></select>
          <select id="birthDay" required></select>
        </div>
      </div>

      <!-- 태어난 시간 -->
      <div class="form-group">
        <label for="birthHour" class="label-bold">태어난 시간</label>
        <select id="birthHour" required>
          <option value="모름">모름</option>
          <option value="자시">자시 (23:30 ~ 01:30)</option>
          <option value="축시">축시 (01:30 ~ 03:30)</option>
          <option value="인시">인시 (03:30 ~ 05:30)</option>
          <option value="묘시">묘시 (05:30 ~ 07:30)</option>
          <option value="진시">진시 (07:30 ~ 09:30)</option>
          <option value="사시">사시 (09:30 ~ 11:30)</option>
          <option value="오시">오시 (11:30 ~ 13:30)</option>
          <option value="미시">미시 (13:30 ~ 15:30)</option>
          <option value="신시">신시 (15:30 ~ 17:30)</option>
          <option value="유시">유시 (17:30 ~ 19:30)</option>
          <option value="술시">술시 (19:30 ~ 21:30)</option>
          <option value="해시">해시 (21:30 ~ 23:30)</option>
        </select>
      </div>

      <!-- 이메일 -->
      <div class="form-group">
        <label for="userEmail" class="label-bold">이메일</label>
        <input
          type="email"
          id="userEmail"
          placeholder="이메일 (예: example@email.com)"
          required
        />
      </div>

      <!-- 버튼 영역 -->
      <div class="button-group">
        <button
          type="button"
          class="custom-jelly-button"
          onclick="showPage('paymentPage')"
        >
          💰 결제하기
        </button>
        <button
          type="button"
          class="custom-jelly-button"
          onclick="showPage('mainPage')"
        >
          ⬅️ 돌아가기
        </button>
      </div>
    </form>
  </div>

<!-- 결제 페이지 -->
<div id="paymentPage" class="page payment-page">
  <h1>💳 결제 진행</h1>
  <div id="userInfo">
    <!-- 입력 정보 확인 UI -->
  </div>
  
  <!-- 토스 위젯 UI를 렌더링할 영역 -->
  <div id="payment-method"></div>
  <div id="agreement"></div>
  

  <button class="custom-jelly-button" onclick="startNaverPay('정통사주', 9900)">
    💚 네이버페이로 결제하기 (9,900원)
  </button>
  <br>
  <button class="custom-jelly-button" onclick="startTossPay('정통사주', 9900)">
    💙 토스로 결제하기 (9,900원)
  </button>
  <br>
  <button class="custom-jelly-button" onclick="showPage('infoPage')">
    ⬅️ 정보 수정
  </button>
</div>

  
<script>

let tossWidgets;  // Toss 위젯 인스턴스를 저장할 변수


    // 날짜 드롭다운 옵션 채우기
function populateDateSelectors() {
    const yearSelect = document.getElementById("birthYear");
    const monthSelect = document.getElementById("birthMonth");
    const daySelect = document.getElementById("birthDay");
    const currentYear = new Date().getFullYear();

    // 연도 선택 (1900년부터 현재까지)
    for (let y = 1900; y <= currentYear; y++) {
        const option = document.createElement("option");
        option.value = y;
        option.text = y;
        yearSelect.add(option);
    }

    // 월 선택
    for (let m = 1; m <= 12; m++) {
        const option = document.createElement("option");
        option.value = m;
        option.text = m;
        monthSelect.add(option);
    }

    // 일 선택
    for (let d = 1; d <= 31; d++) {
        const option = document.createElement("option");
        option.value = d;
        option.text = d;
        daySelect.add(option);
    }
}

function showPage(pageId) {
  const pages = document.querySelectorAll('.page');
  pages.forEach(page => page.classList.remove('active'));
  document.getElementById(pageId).classList.add('active');
  
  if (pageId === 'paymentPage') {
    const userName = document.getElementById("userName").value;
    const userGender = document.getElementById("userGender").value;
    const birthType = document.getElementById("birthType").value;
    const birthYear = document.getElementById("birthYear").value;
    const birthMonth = document.getElementById("birthMonth").value;
    const birthDay = document.getElementById("birthDay").value;
    const birthDate = `${birthYear}-${String(birthMonth).padStart(2, '0')}-${String(birthDay).padStart(2, '0')}`;
    const birthHour = document.getElementById("birthHour").value;
    const userEmail = document.getElementById("userEmail").value;
    
    if (!userName || !birthYear || !birthMonth || !birthDay || !birthHour || !userEmail) {
      alert("모든 정보를 입력해 주세요!");
      showPage('infoPage');
      return;
    }
    
    // 사용자 정보 확인 UI 업데이트
    document.getElementById("userInfo").innerHTML = `
      <h2>입력 정보 확인</h2>
      <p><strong>이름:</strong> ${userName}</p>
      <p><strong>생년월일:</strong> ${birthDate} (${birthType})</p>
      <p><strong>태어난 시간:</strong> ${birthHour}</p>
      <p><strong>이메일:</strong> ${userEmail}</p>
    `;
    
    // 여기서 sessionStorage에 사용자 정보를 저장
    const userData = {
      name: userName,
      gender: userGender,
      birth: birthDate,
      birthType: birthType,
      time: birthHour,
      email: userEmail,
      paymentItem: "정통사주" // 또는 동적으로 설정
    };
    sessionStorage.setItem("userData", JSON.stringify(userData));
    
    // 토스 위젯 UI 렌더링 (가격 9900원으로 설정)
    renderTossWidgets(9900).catch(err => console.error("토스 위젯 렌더링 오류:", err));
  }
}

// 페이지 로드 시 실행
window.onload = function () {
    populateDateSelectors();
};

// 토스 위젯 UI를 렌더링하는 함수
async function renderTossWidgets(price) {
  const tossPayments = TossPayments("live_gck_6bJXmgo28e9AaeqYMave8LAnGKWx");
  // 전역 변수에 할당하여 재사용
  tossWidgets = tossPayments.widgets({ customerKey: TossPayments.ANONYMOUS });
  
  await tossWidgets.setAmount({
    currency: "KRW",
    value: price,
  });
  
  await Promise.all([
    tossWidgets.renderPaymentMethods({
      selector: "#payment-method",
      variantKey: "DEFAULT",
    }),
    tossWidgets.renderAgreement({
      selector: "#agreement",
      variantKey: "AGREEMENT",
    }),
  ]);
}


function startNaverPay(itemName, price) {
    console.log(`🚀 결제 요청: 결제 항목 = ${itemName}`);
    const userName = document.getElementById("userName").value;
    const userGender = document.getElementById("userGender").value;
    const birthYear = document.getElementById("birthYear").value;
    const birthMonth = document.getElementById("birthMonth").value;
    const birthDay = document.getElementById("birthDay").value;
    const birthType = document.getElementById("birthType").value;
    const birthHour = document.getElementById("birthHour").value;
    const userEmail = document.getElementById("userEmail").value;

    if (!userName || !userGender || !birthYear || !birthMonth || !birthDay || !birthType || !birthHour || !userEmail) {
        alert("⚠️ 모든 정보를 입력해 주세요!");
        return;
    }

    const birthDate = `${birthYear}-${String(birthMonth).padStart(2, '0')}-${String(birthDay).padStart(2, '0')}`;
    const paymentItem = itemName;  // 결제 항목 추가

    // ✅ paymentItem을 successUrl에 포함
    const successUrl = `https://test-it.co.kr/saju-success.html?name=${encodeURIComponent(userName)}&gender=${encodeURIComponent(userGender)}&birth=${encodeURIComponent(birthDate)}&birthType=${encodeURIComponent(birthType)}&time=${encodeURIComponent(birthHour)}&email=${encodeURIComponent(userEmail)}&paymentItem=${encodeURIComponent(itemName)}`;


    console.log("🚀 네이버페이 successUrl:", successUrl);

    const oPay = Naver.Pay.create({
        mode: "development",  
        clientId: "HN3GGCMDdTgGUfl0kFCo", 
        chainId: "a3lzdzZ0QmtxSG1"
    });

    oPay.open({
        merchantPayKey: "order_" + new Date().getTime(),
        productName: `테스트잇 정통사주`,
        productCount: "1",
        totalPayAmount: price,
        taxScopeAmount: price,
        returnUrl: successUrl  // ✅ 수정된 successUrl 전달
    });

    alert(`💚 네이버페이로 ${paymentItem} 결제가 진행됩니다!`);
}


async function startTossPay(itemName, price) {
  console.log(`🚀 토스 결제 요청: 결제 항목 = ${itemName}`);

  const userName = document.getElementById("userName").value;
  const userEmail = document.getElementById("userEmail").value;

  if (!userName || !userEmail) {
    alert("⚠️ 모든 정보를 입력해 주세요!");
    return;
  }

  // tossWidgets가 렌더링되어 있지 않으면 오류 처리
  if (!tossWidgets) {
    alert("결제 위젯이 초기화되지 않았습니다. 결제 페이지를 새로고침 해주세요.");
    return;
  }

  try {
    const response = await tossWidgets.requestPayment({
      orderId: `order_${Date.now()}`,
      orderName: itemName,
      successUrl: "https://test-it.co.kr/saju-success.html",
      failUrl: "https://test-it.co.kr/payment-fail1",
      customerName: userName,
      customerEmail: userEmail,
    });
    console.log("✅ 결제 성공:", response);
  } catch (error) {
    console.error("❌ 결제 실패:", error);
    alert(`❌ 결제 실패: ${error.message}`);
  }
}


// 결제 전 사용자 정보 저장 (예시)
const userData = {
  name: document.getElementById("userName").value,
  gender: document.getElementById("userGender").value,
  birth: `${document.getElementById("birthYear").value}-${String(document.getElementById("birthMonth").value).padStart(2, '0')}-${String(document.getElementById("birthDay").value).padStart(2, '0')}`,
  birthType: document.getElementById("birthType").value,
  time: document.getElementById("birthHour").value,
  email: document.getElementById("userEmail").value,
  paymentItem: "정통사주" // 또는 동적으로 설정
};
sessionStorage.setItem("userData", JSON.stringify(userData));


    
function sendToGoogleSheet(userName, userGender, birthDate, birthType, birthTime, userEmail, paymentItem) {
    console.log("📤 전송할 데이터:", userName, userGender, birthDate, birthType, birthTime, userEmail, paymentItem);


    fetch("https://script.google.com/macros/s/AKfycbzSWc97F6-n1z0h6y0i2lhK7PJBkH31NNC6wkgygIa7mzYlifA5nbxqS1DcOcCUQ0vF/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            userName: userName,
            userGender: userGender,
            birthDate: birthDate,
            birthType: birthType,
            birthTime: birthTime,
            userEmail: userEmail,
            paymentItem: paymentItem,  // ✅ 여기서도 추가!
            paymentTime: new Date().toLocaleString()
        })
    })
    .then(() => {
        console.log("✅ 구글 시트에 데이터 전송 완료!");
    })
    .catch(error => {
        console.error("❌ 데이터 전송 실패:", error);
    });
}

// ✅ 페이지 로딩 시 실행
window.onload = function () {
    // 날짜 셀렉터 초기화
    populateDateSelectors();

    // 결제 성공 후 URL 파라미터 확인
    const urlParams = new URLSearchParams(window.location.search);
    const userName = urlParams.get("name");
    const userGender = urlParams.get("gender");
    const birthDate = urlParams.get("birth");
    const birthType = urlParams.get("birthType");
    const birthTime = urlParams.get("time");
    const userEmail = urlParams.get("email");
    const paymentItem = urlParams.get("paymentItem");

    // ✅ 모든 필수 정보가 있을 때만 처리
    if (userName && userGender && birthDate && birthType && birthTime && userEmail && paymentItem) {
        console.log("✅ 결제 성공! 정보가 전달되었습니다.");
        console.log(`이름: ${userName}, 성별: ${userGender}, 생년월일: ${birthDate}, 이메일: ${userEmail}, 결제항목: ${paymentItem}`);

        // 구글 시트로 데이터 전송
        sendToGoogleSheet(userName, userGender, birthDate, birthType, birthTime, userEmail, paymentItem);

        // 성공 알림
        alert(`✅ 결제가 완료되었습니다!\n이름: ${userName}\n성별: ${userGender}\n이메일: ${userEmail}\n결제 항목: ${paymentItem}`);
    } else {
        console.log("❌ 결제 성공 정보가 없으므로 아무 작업도 하지 않습니다.");
    }
};

console.log("🚀 TossPayments 키:", tossPayments);
console.log("🚀 현재 환경:", window.location.hostname);

  </script>
</body>
</html>